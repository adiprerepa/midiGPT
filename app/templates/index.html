<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Music Tool</title>
<style>
    body {
        font-family: Arial, sans-serif;
        background-color: #f2f2f2;
    }
    .tab {
        overflow: hidden;
        border: 1px solid #ccc;
        background-color: #333;
    }
    .tab button {
        background-color: inherit;
        float: left;
        border: none;
        outline: none;
        cursor: pointer;
        padding: 14px 16px;
        transition: 0.3s;
        font-size: 17px;
        color: #fff;
    }
    .tab button:hover {
        background-color: #555;
    }
    .tab button.active {
        background-color: #f44336;
    }
    .tabcontent {
        display: none;
        padding: 20px;
        border: 1px solid #ccc;
        border-top: none;
        border-radius: 8px;
        background-color: #f9f9f9;
        box-shadow: 5px 5px 15px #e0e0e0, -5px -5px 15px #ffffff;
    }
    .file-upload-button {
        display: inline-block;
        padding: 10px 20px;
        border: 2px solid #ccc;
        border-radius: 10px;
        background-color: #f9f9f9;
        cursor: pointer;
        transition: all 0.3s ease-in-out;
        box-shadow: 3px 3px 5px #c9c9c9, -3px -3px 5px #ffffff;
    }
    .file-upload-button:hover {
        background-color: #f0f0f0;
        box-shadow: 3px 3px 5px #c9c9c9 inset, -3px -3px 5px #ffffff inset;
    }
    .generate-button {
        display: inline-block;
        padding: 10px 20px;
        border: 2px solid #f44336;
        border-radius: 10px;
        background-color: #f44336;
        cursor: pointer;
        transition: all 0.3s ease-in-out;
        color: #fff;
        font-weight: bold;
    }
    .generate-button:hover {
        background-color: #ff6659;
        border-color: #ff6659;
    }
    #GenerateMusic {background-color: lightblue;}
    #DetectWatermark {background-color: lightblue;}
</style>
</head>
<body>

<div class="tab">
    <button class="tablinks active" onclick="openTab(event, 'GenerateMusic')">Generate Music</button>
    <button class="tablinks" onclick="openTab(event, 'DetectWatermark')">Detect Watermark</button>
</div>

<div id="GenerateMusic" class="tabcontent" style="display:block;">
    <h3>Upload MP3 for Music Generation</h3>
    <label for="musicFile1" class="file-upload-button">Choose File</label>
    <input type="file" id="musicFile1" name="musicFile1" style="display: none;" onchange="updateFile(this)">
    <button class="generate-button" onclick="generateMusic()">Generate!</button>
    <!-- Add more elements here for music generation -->
</div>

<div id="DetectWatermark" class="tabcontent">
    <h3>Upload MP3 for Watermark Detection</h3>
    <label for="musicFile2" class="file-upload-button">Choose File</label>
    <input type="file" id="musicFile2" name="musicFile2" style="display: none;" onchange="updateFile(this)">
    <button class="generate-button" onclick="detectWatermark()">Detect!</button>
    <meter id="confidenceMeter" min="0" max="1" value="0"></meter>
</div>

<audio id="audioPlayer" controls style="margin-top: 20px; display: none;"></audio>

<script>
    function openTab(evt, tabName) {
        var i, tabcontent, tablinks;
        tabcontent = document.getElementsByClassName("tabcontent");
        for (i = 0; i < tabcontent.length; i++) {
            tabcontent[i].style.display = "none";
        }
        tablinks = document.getElementsByClassName("tablinks");
        for (i = 0; i < tablinks.length; i++) {
            tablinks[i].className = tablinks[i].className.replace(" active", "");
        }
        document.getElementById(tabName).style.display = "block";
        evt.currentTarget.className += " active";
    }

    function updateFile(input) {
        var audioPlayer = document.getElementById('audioPlayer');
        // Check if a file is selected
        if (input.files.length > 0) {
            // Update the content of the audio player with the file name
            audioPlayer.src = URL.createObjectURL(input.files[0]);
            audioPlayer.style.display = 'block';
        } else {
            // If no file is selected, clear the audio player
            audioPlayer.src = '';
            audioPlayer.style.display = 'none';
        }
    }

    function generateMusic() {
        // Get the selected file
        var fileInput = document.getElementById('musicFile1');
        var file = fileInput.files[0];

        // Check if a file is selected
        if (!file) {
            alert("Please select a file.");
            return;
        }

        // Create FormData object to send file
        var formData = new FormData();
        formData.append('music_file', file);

        // Make AJAX request to Flask API
        var xhr = new XMLHttpRequest();
        xhr.open('POST', '/generate_music', true);
        xhr.onload = function () {
            if (xhr.status === 200) {
                var response = JSON.parse(xhr.responseText);
                // Handle the response from the Flask API
                alert("Music generated successfully!");
                // Download the generated mp3 file in response
                var blob = new Blob([response.data], {type: 'audio/mpeg'});
                var url = URL.createObjectURL(blob);
                var a = document.createElement('a');
                a.href = url;
                a.download = 'generated_music.mp3';
                document.body.appendChild(a);
                a.click();
                window.URL.revokeObjectURL(url);
            } else {
                alert("Error generating music: " + xhr.statusText);
            }
        };
        xhr.onerror = function () {
            alert("Network error occurred.");
        };
        xhr.send(formData);
    }

    function detectWatermark() {
        var confidence = 0.75; // Example confidence value

        // Update the value of the meter element with the confidence percentage
        var meter = document.getElementById('confidenceMeter');
        meter.value = confidence;
        return;
        // Get the selected file
        var fileInput = document.getElementById('musicFile2');
        var file = fileInput.files[0];

        // Check if a file is selected
        if (!file) {
            alert("Please select a file.");
            return;
        }

        // Create FormData object to send file
        var formData = new FormData();
        formData.append('music_file', file);

        // Make AJAX request to Flask API
        var xhr = new XMLHttpRequest();
        xhr.open('POST', '/detect_watermark', true);
        xhr.onload = function () {
            if (xhr.status === 200) {
                var response = JSON.parse(xhr.responseText);
                // Handle the response from the Flask API
                alert("Watermark detected successfully!");
            } else {
                alert("Error detecting watermark: " + xhr.statusText);
            }
        };
        xhr.onerror = function () {
            alert("Network error occurred.");
        };
        xhr.send(formData);
    }
</script>

</body>
</html>
